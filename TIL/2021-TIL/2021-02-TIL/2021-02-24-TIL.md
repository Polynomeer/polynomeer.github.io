# 2021-02-24-TIL

## "Read-only" Instance - Collections.unmodifiableList()

```java
class ClassA {
		public void callee (List<String> copiedList) {
				copiedList.remove(0); // This must be banned!
		}
}
```

```java
class ClassB {
		public void caller () {
				ClassA a = new ClassA();
				List<String> originalList = new ArrayList<>();
				originalList.add("java");
				originalList.add("Collections");
				originalList.add("unmodifiableList");
				a.callee(originalList);
		}
}
```

자바에서 객체를 리턴해주면 얕은 복사(shallow copy)가 되어서 넘어간다. 즉, `List<String> copiedList` 변수에 `ArrayList<String> originalList` 객체를 넘겨주면 객체의 주소가 직접 복사되어 넘어간다. 따라서 참조 변수를 통해 remove 등 배열의 요소에 접근하여 수정을 할 수 있는 문제가 발생한다. 따라서 읽기 전용으로 사용하고자 할 때, 외부클래스에서 수정을 못하도록 Collections.unmodifiableList를 사용하여 막을 수 있다.

참고로, final로 선언해도  그 참조값만 바꿀 수가 없다는 것이지 List의 각 요소는 얼마든지 바뀔 수 가 있다. 그렇기 때문에 불변객체로 선언하여 각 요소에 대한 수정까지 완전히 막아주는 것이 바람직하다.

https://www.techiedelight.com/unmodifiable-list-java/